<h1>List of users</h1>
<table border="1">
<tr>
  <th>Username</th>
  <th>Private?</th>
  <th></th>
  <th></th>
</tr>
<tr>
<%@list_of_users.each do |user|%>
<td><%= user.username%></td>
<td><%= user.private ? 'yes' : 'no' %></td>

<td>
<% if session[:user_id].present? %>

<% matching_requests = FollowRequest.where({:sender_id => @current_user.id}).where({:recipient_id => user.id}).at(0) %>

<%if matching_requests != nil && matching_requests.status == "accepted" %>
<a href="/delete_follow_request/<%= matching_requests.id%>">Unfollow</a>
<%elsif matching_requests != nil && matching_requests.status == "pending"%>
Request sent. 
<a href="/delete_follow_request/<%= matching_requests.id%>">Cancel</a>
<% else %>

<form action="/insert_follow_request" method="post">
<input type="hidden" name="query_sender_id" value="<%= @current_user.id %>" >
<input type="hidden" name="query_recipient_id" value="<%= user.id %>">
<button>Follow</button>

</form>
<% end %>
<%end%>
</td>
<% if session[:user_id].present? %>

<td><a href="/users/<%=user.username%>">show details</a></td>
<%else%>
<td><a href="/user_sign_up">show details</a></td>
<% end %>

</tr>

<%end%>
</table>
